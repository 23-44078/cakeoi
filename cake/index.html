<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sweet Delights - Cake Ordering System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #89CFF0; /* Baby blue */
            --primary-dark: #6bb8e0; /* Darker baby blue */
            --secondary: #8b5cf6;
            --accent: #f59e0b;
            --light: #f0f9ff; /* Light baby blue tint */
            --dark: #2c4a6a; /* Dark blue-gray */
            --gray: #6b7280;
            --light-gray: #f3f4f6;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --transition: all 0.3s ease;
        }

        body {
            background-color: var(--light);
            color: var(--dark);
            line-height: 1.6;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Login Page Styles */
        .login-page {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            position: relative;
            overflow: hidden;
        }

        .login-page::before {
            content: '';
            position: absolute;
            width: 100px;
            height: 100px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="%23ffffff" opacity="0.1" d="M50,15 C60,5 80,5 90,15 C100,25 100,45 90,55 C80,65 60,65 50,55 C40,65 20,65 10,55 C0,45 0,25 10,15 C20,5 40,5 50,15 Z"/></svg>');
            animation: float 20s infinite linear;
        }

        .login-page::after {
            content: '';
            position: absolute;
            width: 150px;
            height: 150px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="%23ffffff" opacity="0.1" d="M50,15 C60,5 80,5 90,15 C100,25 100,45 90,55 C80,65 60,65 50,55 C40,65 20,65 10,55 C0,45 0,25 10,15 C20,5 40,5 50,15 Z"/></svg>');
            animation: float 25s infinite linear reverse;
            right: 10%;
            top: 20%;
        }

        @keyframes float {
            0% {
                transform: translateY(0) rotate(0deg);
            }
            100% {
                transform: translateY(-1000px) rotate(360deg);
            }
        }

        .login-container {
            background-color: white;
            border-radius: 12px;
            padding: 40px;
            box-shadow: var(--shadow);
            width: 90%;
            max-width: 400px;
            text-align: center;
            position: relative;
            z-index: 10;
            animation: loginSlideIn 1s ease-out;
        }

        @keyframes loginSlideIn {
            0% {
                opacity: 0;
                transform: translateY(-50px) scale(0.9);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .login-container::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: rotate(45deg);
            animation: shimmer 3s infinite;
            z-index: 1;
        }

        @keyframes shimmer {
            0% {
                transform: translateX(-100%) translateY(-100%) rotate(45deg);
            }
            100% {
                transform: translateX(100%) translateY(100%) rotate(45deg);
            }
        }

        .login-logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            animation: logoFloat 3s ease-in-out infinite;
        }

        @keyframes logoFloat {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        .login-logo-img {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            padding: 5px;
            box-shadow: var(--shadow);
            animation: pulse 2s infinite;
        }

        .login-logo-img img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            border-radius: 50%;
        }

        .login-title {
            font-size: 28px;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 30px;
        }

        .login-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--light-gray);
        }

        .login-tab {
            flex: 1;
            padding: 12px;
            text-align: center;
            background: transparent;
            border: none;
            cursor: pointer;
            font-weight: 600;
            color: var(--gray);
            transition: var(--transition);
            border-bottom: 3px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .login-tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .login-tab.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: var(--primary);
            animation: tabSlide 0.3s ease-out;
        }

        @keyframes tabSlide {
            0% {
                transform: translateX(-100%);
            }
            100% {
                transform: translateX(0);
            }
        }

        .login-error {
            color: var(--danger);
            margin-top: 10px;
            text-align: center;
            font-size: 14px;
            min-height: 20px;
        }

        /* Enhanced Username Suggestions Styles */
        .suggestions-container {
            position: relative;
        }

        .suggestions-list {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid var(--light-gray);
            border-radius: 8px;
            box-shadow: var(--shadow);
            z-index: 100;
            max-height: 200px;
            overflow-y: auto;
            display: none;
            animation: fadeIn 0.2s ease-out;
            margin-top: 5px;
        }

        .suggestion-item {
            padding: 10px 15px;
            cursor: pointer;
            transition: var(--transition);
            border-bottom: 1px solid var(--light-gray);
            display: flex;
            align-items: center;
            gap: 10px;
            position: relative;
        }

        .suggestion-item:last-child {
            border-bottom: none;
        }

        .suggestion-item:hover {
            background-color: rgba(137, 207, 240, 0.1);
        }

        .suggestion-item.active {
            background-color: rgba(137, 207, 240, 0.1);
            color: var(--primary);
        }

        .suggestion-icon {
            color: var(--primary);
            font-size: 14px;
            width: 16px;
            text-align: center;
        }

        .suggestion-username {
            flex: 1;
            font-weight: 500;
        }

        .suggestion-role {
            font-size: 12px;
            color: var(--gray);
            background: var(--light-gray);
            padding: 2px 8px;
            border-radius: 10px;
        }

        .suggestions-header {
            padding: 8px 15px;
            font-size: 12px;
            color: var(--gray);
            border-bottom: 1px solid var(--light-gray);
            background-color: var(--light-gray);
            font-weight: 600;
        }

        .suggestion-item.recent {
            border-left: 3px solid var(--primary);
        }

        .suggestion-item.recent .suggestion-icon {
            color: var(--secondary);
        }

        .no-suggestions {
            padding: 15px;
            text-align: center;
            color: var(--gray);
            font-style: italic;
        }

        /* Animation for suggestions */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Keyboard navigation highlight */
        .suggestion-item.highlighted {
            background-color: var(--primary);
            color: white;
        }

        .suggestion-item.highlighted .suggestion-icon,
        .suggestion-item.highlighted .suggestion-role {
            color: white;
        }

        .suggestion-item.highlighted .suggestion-role {
            background: rgba(255, 255, 255, 0.2);
        }

        /* Dashboard Styles */
        .dashboard {
            display: none;
        }

        .dashboard.active {
            display: block;
        }

        /* Header Styles */
        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 20px 0;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
            animation: slideDown 0.5s ease;
        }

        @keyframes slideDown {
            from { transform: translateY(-100%); }
            to { transform: translateY(0); }
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 32px;
            font-weight: 700;
        }

        .logo-img {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            padding: 5px;
            box-shadow: 
                0 10px 20px rgba(0,0,0,0.19), 
                0 6px 6px rgba(0,0,0,0.23),
                inset 0 -2px 5px rgba(0,0,0,0.1),
                inset 0 2px 5px rgba(255,255,255,0.5);
            animation: pulse 2s infinite;
            position: relative;
            transform-style: preserve-3d;
            perspective: 500px;
        }

        .logo-img::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.3) 0%, rgba(255,255,255,0) 50%);
            border-radius: 50%;
            z-index: 2;
        }

        @keyframes pulse {
            0% { transform: scale(1) rotateY(0deg); }
            50% { transform: scale(1.05) rotateY(5deg); }
            100% { transform: scale(1) rotateY(0deg); }
        }

        .logo-img img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            border-radius: 50%;
            transform: translateZ(10px);
            filter: drop-shadow(0 5px 10px rgba(0,0,0,0.2));
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-details {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-type {
            background-color: rgba(255, 255, 255, 0.2);
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 14px;
            backdrop-filter: blur(10px);
        }

        .btn {
            background-color: white;
            color: var(--primary);
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        /* Navigation Styles */
        nav {
            background-color: white;
            padding: 15px 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
            animation: fadeIn 0.7s ease;
        }

        .nav-container {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .nav-section {
            display: flex;
            gap: 10px;
        }

        .nav-btn {
            background: transparent;
            color: var(--gray);
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-btn:hover {
            background-color: var(--light-gray);
            color: var(--dark);
        }

        .nav-btn.active {
            background-color: var(--primary);
            color: white;
            animation: bounce 0.5s;
        }

        @keyframes bounce {
            0%, 20%, 60%, 100% { transform: translateY(0); }
            40% { transform: translateY(-5px); }
            80% { transform: translateY(-2px); }
        }

        /* Main Content Styles */
        .content {
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
            margin-bottom: 40px;
            flex: 1;
        }

        .main-content {
            background-color: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--shadow);
            min-height: 600px;
            animation: fadeIn 0.5s ease;
        }

        .section {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section.active {
            display: block;
        }

        .section-title {
            margin-bottom: 25px;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
            font-weight: 700;
        }

        /* Mission & Vision Styles */
        .mission-vision {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        .mission-card, .vision-card {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .mission-card:hover, .vision-card:hover {
            transform: translateY(-5px);
        }

        .mission-card {
            border-left: 5px solid var(--primary);
        }

        .vision-card {
            border-left: 5px solid var(--secondary);
        }

        .mission-vision h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            color: var(--dark);
        }

        .mission-vision p {
            line-height: 1.7;
            color: var(--gray);
        }

        /* Contact Info Styles */
        .contact-info {
            background-color: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--shadow);
            margin-top: 30px;
        }

        .contact-info h3 {
            margin-bottom: 20px;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .contact-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .contact-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background-color: var(--light-gray);
            border-radius: 8px;
            transition: var(--transition);
        }

        .contact-item:hover {
            background-color: rgba(137, 207, 240, 0.1);
            transform: translateY(-2px);
        }

        .contact-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        /* Footer Styles */
        footer {
            background: linear-gradient(135deg, var(--dark), #1a2f4a);
            color: white;
            padding: 20px 0;
            margin-top: auto;
            text-align: center;
        }

        .footer-bottom {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
        }

        /* Menu Grid Styles */
        .menu-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 25px;
        }

        .menu-item {
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            background-color: white;
            animation: zoomIn 0.5s ease;
        }

        @keyframes zoomIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        .menu-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        .menu-item-img {
            height: 180px;
            width: 100%;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f9f9f9;
        }

        .menu-item-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .menu-item:hover .menu-item-img img {
            transform: scale(1.05);
        }

        .menu-item-content {
            padding: 20px;
        }

        .menu-item-title {
            font-size: 18px;
            margin-bottom: 8px;
            color: var(--dark);
            font-weight: 600;
        }

        .menu-item-desc {
            color: var(--gray);
            font-size: 14px;
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .menu-item-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .price {
            font-weight: 700;
            color: var(--primary);
            font-size: 18px;
        }

        .add-to-cart {
            background-color: var(--primary);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .add-to-cart:hover {
            background-color: var(--primary-dark);
            transform: scale(1.1);
        }

        /* Cart Styles */
        .cart-cards {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }

        .cart-card {
            background-color: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            animation: fadeIn 0.5s ease;
        }

        .cart-item-img {
            width: 80px;
            height: 80px;
            border-radius: 8px;
            overflow: hidden;
            margin-right: 20px;
            flex-shrink: 0;
        }

        .cart-item-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .cart-item-details {
            flex: 1;
        }

        .cart-item-name {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--dark);
        }

        .cart-item-price {
            color: var(--primary);
            font-weight: 600;
            margin-bottom: 10px;
        }

        .cart-item-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .quantity-btn {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: none;
            background-color: var(--light-gray);
            color: var(--dark);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .quantity-btn:hover {
            background-color: var(--primary);
            color: white;
        }

        .remove-btn {
            background-color: transparent;
            border: none;
            color: var(--danger);
            cursor: pointer;
            margin-left: 15px;
            transition: var(--transition);
        }

        .remove-btn:hover {
            color: var(--danger);
            transform: scale(1.1);
        }

        .cart-item-subtotal {
            font-weight: 600;
            color: var(--dark);
            margin-left: 20px;
        }

        .cart-empty {
            text-align: center;
            padding: 40px;
            color: var(--gray);
            font-style: italic;
        }

        .cart-summary {
            background-color: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: var(--shadow);
            height: fit-content;
            margin-top: 20px;
        }

        .cart-total {
            font-weight: 700;
            font-size: 20px;
            margin-top: 20px;
            text-align: right;
            padding-top: 20px;
            border-top: 2px solid var(--light-gray);
        }

        .checkout-btn {
            background-color: var(--secondary);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            margin-top: 20px;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .checkout-btn:hover {
            background-color: #7c3aed;
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .checkout-btn:disabled {
            background-color: var(--gray);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Table Styles */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            box-shadow: var(--shadow);
            border-radius: 8px;
            overflow: hidden;
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid var(--light-gray);
        }

        th {
            background-color: var(--light-gray);
            font-weight: 600;
            color: var(--dark);
        }

        tr:hover {
            background-color: rgba(0, 0, 0, 0.02);
        }

        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-pending {
            background-color: #fef3c7;
            color: #d97706;
            animation: pulseWarning 2s infinite;
        }

        .status-preparing {
            background-color: #dbeafe;
            color: #1d4ed8;
            animation: pulseInfo 2s infinite;
        }

        .status-ready {
            background-color: #d1fae5;
            color: #065f46;
            animation: pulseSuccess 2s infinite;
        }

        .status-delivered {
            background-color: #d1fae5;
            color: #065f46;
            animation: tada 1s;
        }

        .status-cancelled {
            background-color: #f3e8ff;
            color: #7e22ce;
        }

        @keyframes pulseWarning {
            0% {
                box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.7);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(245, 158, 11, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(245, 158, 11, 0);
            }
        }

        @keyframes pulseInfo {
            0% {
                box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(59, 130, 246, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(59, 130, 246, 0);
            }
        }

        @keyframes pulseSuccess {
            0% {
                box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(16, 185, 129, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(16, 185, 129, 0);
            }
        }

        @keyframes tada {
            0% {
                transform: scale(1);
            }
            10%, 20% {
                transform: scale(0.9) rotate(-3deg);
            }
            30%, 50%, 70%, 90% {
                transform: scale(1.1) rotate(3deg);
            }
            40%, 60%, 80% {
                transform: scale(1.1) rotate(-3deg);
            }
            100% {
                transform: scale(1) rotate(0);
            }
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 20px;
            position: relative;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }

        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--light-gray);
            border-radius: 8px;
            font-size: 16px;
            transition: var(--transition);
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(137, 207, 240, 0.2);
        }

        /* Password Field Styles */
        .password-container {
            position: relative;
        }

        .toggle-password {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--gray);
            cursor: pointer;
            transition: var(--transition);
        }

        .toggle-password:hover {
            color: var(--primary);
        }

        /* Payment Styles */
        .payment-container {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
        }

        .payment-methods-container {
            background-color: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: var(--shadow);
        }

        .payment-form-container {
            background-color: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: var(--shadow);
            height: fit-content;
        }

        /* Payment methods side by side */
        .payment-methods {
            display: flex;
            gap: 20px;
            margin: 25px 0;
        }

        .payment-method {
            flex: 1;
            border: 2px solid var(--light-gray);
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            animation: zoomIn 0.5s ease;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .payment-method:hover {
            border-color: var(--primary);
            transform: scale(1.05);
        }

        .payment-method.selected {
            border-color: var(--primary);
            background-color: rgba(137, 207, 240, 0.05);
            animation: pulse 0.5s;
        }

        .payment-icon {
            font-size: 30px;
            margin-bottom: 10px;
            color: var(--gray);
        }

        .payment-method.selected .payment-icon {
            color: var(--primary);
        }

        /* GCash Payment Styles */
        .gcash-payment {
            background: linear-gradient(135deg, #0033A0, #00A3E0);
            color: white;
        }

        .gcash-payment .payment-icon {
            color: white;
        }

        .gcash-payment.selected {
            border-color: #0033A0;
            background: linear-gradient(135deg, #0033A0, #00A3E0);
        }

        .gcash-logo {
            width: 80px;
            height: 80px;
            margin: 0 auto 10px;
            background: white;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 10px;
        }

        .gcash-logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .gcash-instructions {
            background-color: rgba(0, 51, 160, 0.1);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .gcash-instructions ol {
            margin-left: 20px;
            margin-bottom: 10px;
        }

        .gcash-instructions li {
            margin-bottom: 8px;
        }

        /* User List Styles */
        .user-list {
            list-style-type: none;
        }

        .user-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid var(--light-gray);
            transition: var(--transition);
            animation: slideInRight 0.3s ease;
            border-radius: 8px;
            margin-bottom: 10px;
            box-shadow: var(--shadow);
        }

        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .user-item:hover {
            background-color: var(--light-gray);
        }

        .user-role {
            background-color: var(--light-gray);
            color: var(--dark);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .user-actions {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 16px;
            transition: var(--transition);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .edit-btn {
            color: var(--secondary);
        }

        .edit-btn:hover {
            background-color: rgba(139, 92, 246, 0.1);
        }

        .delete-btn {
            color: var(--danger);
        }

        .delete-btn:hover {
            background-color: rgba(239, 68, 68, 0.1);
        }

        /* Track Order Styles */
        .tracking-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }

        .order-card {
            background-color: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: var(--shadow);
            margin-bottom: 20px;
            animation: cardSlideIn 0.5s ease-out;
        }

        @keyframes cardSlideIn {
            0% {
                opacity: 0;
                transform: translateX(-20px);
            }
            100% {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--light-gray);
            padding-bottom: 15px;
        }

        .order-id {
            font-weight: 700;
            color: var(--dark);
            font-size: 18px;
        }

        .order-date {
            color: var(--gray);
            font-size: 14px;
        }

        .order-status {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-top: 5px;
        }

        .status-ready {
            background-color: #d1fae5;
            color: #065f46;
        }

        .status-pending {
            background-color: #fef3c7;
            color: #d97706;
        }

        .status-preparing {
            background-color: #dbeafe;
            color: #1d4ed8;
        }

        .status-delivered {
            background-color: #d1fae5;
            color: #065f46;
        }

        .status-cancelled {
            background-color: #f3e8ff;
            color: #7e22ce;
        }

        .order-details {
            margin-bottom: 20px;
        }

        .order-detail-row {
            display: flex;
            margin-bottom: 10px;
        }

        .order-detail-label {
            font-weight: 600;
            width: 150px;
            color: var(--dark);
        }

        .order-detail-value {
            flex: 1;
            color: var(--gray);
        }

        .tracking-progress {
            margin-top: 25px;
        }

        .progress-steps {
            display: flex;
            justify-content: space-between;
            position: relative;
            margin-bottom: 10px;
        }

        .progress-steps::before {
            content: '';
            position: absolute;
            top: 15px;
            left: 0;
            right: 0;
            height: 4px;
            background-color: var(--light-gray);
            z-index: 1;
        }

        .progress-bar {
            position: absolute;
            top: 15px;
            left: 0;
            height: 4px;
            background-color: var(--primary);
            z-index: 2;
            transition: width 0.5s ease;
            animation: progressFill 1.5s ease-out;
        }

        @keyframes progressFill {
            0% {
                width: 0%;
            }
            100% {
                width: var(--progress-width);
            }
        }

        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 3;
        }

        .step-icon {
            width: 34px;
            height: 34px;
            border-radius: 50%;
            background-color: var(--light-gray);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 8px;
            transition: var(--transition);
            position: relative;
            z-index: 10;
        }

        .step-active .step-icon {
            background-color: var(--primary);
            color: white;
            animation: bounce 1s infinite, glow 2s infinite alternate;
        }

        @keyframes glow {
            0% {
                box-shadow: 0 0 5px var(--primary);
            }
            100% {
                box-shadow: 0 0 20px var(--primary), 0 0 30px var(--primary);
            }
        }

        .step-completed .step-icon {
            background-color: var(--success);
            color: white;
            animation: pulseSuccess 1.5s infinite;
            box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7);
        }

        .step-label {
            font-size: 12px;
            color: var(--gray);
            text-align: center;
        }

        .step-active .step-label {
            color: var(--primary);
            font-weight: 600;
        }

        .step-completed .step-label {
            color: var(--success);
            font-weight: 600;
        }

        .tracking-summary {
            background-color: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: var(--shadow);
            height: fit-content;
            margin-top: 20px;
        }

        /* Order History Styles */
        .order-history-cards {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }

        .history-card {
            background-color: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: var(--shadow);
            animation: fadeIn 0.5s ease;
        }

        .history-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
            border-bottom: 1px solid var(--light-gray);
            padding-bottom: 15px;
        }

        .history-order-id {
            font-weight: 700;
            color: var(--dark);
            font-size: 18px;
        }

        .history-order-date {
            color: var(--gray);
            font-size: 14px;
        }

        .history-status {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-top: 5px;
        }

        .history-details {
            margin-bottom: 15px;
        }

        .history-detail-row {
            display: flex;
            margin-bottom: 8px;
        }

        .history-detail-label {
            font-weight: 600;
            width: 120px;
            color: var(--dark);
        }

        .history-detail-value {
            flex: 1;
            color: var(--gray);
        }

        .order-history-empty {
            text-align: center;
            padding: 40px;
            color: var(--gray);
            font-style: italic;
        }

        /* Manage Users Section */
        .users-table-container {
            background-color: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: var(--shadow);
            overflow-x: auto;
        }

        .users-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 700px;
        }

        .users-table th,
        .users-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid var(--light-gray);
        }

        .users-table th {
            background-color: var(--light-gray);
            font-weight: 600;
            color: var(--dark);
        }

        .users-table tr:hover {
            background-color: rgba(0, 0, 0, 0.02);
        }

        .users-summary {
            background-color: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: var(--shadow);
            height: fit-content;
            margin-top: 20px;
        }

        /* Notification Styles */
        .notification {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.8);
            background: white;
            color: var(--dark);
            padding: 20px 30px;
            border-radius: 16px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            display: flex;
            align-items: center;
            gap: 15px;
            max-width: 450px;
            text-align: left;
            border-left: 5px solid var(--primary);
        }

        .notification.show {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
        }

        .notification-icon {
            font-size: 24px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .notification-success .notification-icon {
            background-color: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .notification-error .notification-icon {
            background-color: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }

        .notification-warning .notification-icon {
            background-color: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }

        .notification-info .notification-icon {
            background-color: rgba(139, 92, 246, 0.1);
            color: var(--secondary);
        }

        .notification-content {
            flex: 1;
        }

        .notification-title {
            font-weight: 700;
            margin-bottom: 5px;
            font-size: 16px;
        }

        .notification-message {
            font-size: 14px;
            color: var(--gray);
        }

        /* Staff Action Table Styles */
        .action-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .action-table th, .action-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid var(--light-gray);
        }

        .action-table th {
            background-color: var(--light-gray);
            font-weight: 600;
            color: var(--dark);
        }

        .action-table tr:hover {
            background-color: rgba(0, 0, 0, 0.02);
        }

        .action-table .status-select {
            padding: 8px 12px;
            border-radius: 6px;
            border: 1px solid var(--light-gray);
            background-color: white;
            font-size: 14px;
            width: 100%;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background-color: white;
            border-radius: 12px;
            padding: 30px;
            width: 90%;
            max-width: 600px;
            box-shadow: var(--shadow);
            animation: modalFadeIn 0.3s ease;
            max-height: 90vh;
            overflow-y: auto;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--dark);
        }

        .close-modal {
            background: transparent;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--gray);
            transition: var(--transition);
        }

        .close-modal:hover {
            color: var(--dark);
        }

        .modal-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 20px;
        }

        .modal-btn {
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
        }

        .modal-btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .modal-btn-secondary {
            background-color: var(--light-gray);
            color: var(--dark);
        }

        .modal-btn-danger {
            background-color: var(--danger);
            color: white;
        }

        .modal-btn-danger:hover {
            background-color: #dc2626;
        }

        /* Single line location input */
        .single-line-location {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--light-gray);
            border-radius: 8px;
            font-size: 16px;
            transition: var(--transition);
            margin-top: 10px;
        }

        .single-line-location:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(137, 207, 240, 0.2);
        }

        /* Contact info in payment */
        .contact-info-payment {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        /* Cancel Order Button Styles */
        .cancel-order-btn {
            background-color: var(--danger);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 5px;
            margin-top: 10px;
        }

        .cancel-order-btn:hover {
            background-color: #dc2626;
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .cancel-order-btn:disabled {
            background-color: var(--gray);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Cancel Order Confirmation Modal */
        .cancel-confirmation-modal .modal-content {
            max-width: 500px;
        }

        .cancel-reason {
            margin: 15px 0;
        }

        .cancel-reason textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--light-gray);
            border-radius: 8px;
            resize: vertical;
            min-height: 100px;
        }

        /* Responsive Design */
        @media (max-width: 968px) {
            .content {
                grid-template-columns: 1fr;
            }
            
            .nav-container {
                flex-direction: column;
                gap: 15px;
            }
            
            .nav-section {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .mission-vision {
                grid-template-columns: 1fr;
            }
            
            .contact-details {
                grid-template-columns: 1fr;
            }
            
            .menu-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .payment-container {
                grid-template-columns: 1fr;
            }
            
            .payment-methods {
                flex-direction: column;
            }

            .contact-info-payment {
                grid-template-columns: 1fr;
            }
            
            .users-table {
                min-width: 600px;
            }
        }

        @media (max-width: 640px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            
            .menu-grid {
                grid-template-columns: 1fr;
            }
            
            .payment-methods {
                grid-template-columns: 1fr;
            }
            
            .logo {
                font-size: 26px;
            }
            
            .logo-img {
                width: 70px;
                height: 70px;
            }
            
            .user-info {
                flex-direction: column;
                gap: 10px;
            }
            
            .user-details {
                flex-direction: column;
                gap: 5px;
                text-align: center;
            }
            
            .notification {
                width: 90%;
                max-width: 90%;
                padding: 15px 20px;
            }
            
            .cart-card {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .cart-item-img {
                margin-right: 0;
                margin-bottom: 15px;
            }
            
            .cart-item-subtotal {
                margin-left: 0;
                margin-top: 15px;
                align-self: flex-end;
            }
            
            .order-detail-row, .history-detail-row {
                flex-direction: column;
            }
            
            .order-detail-label, .history-detail-label {
                width: 100%;
                margin-bottom: 5px;
            }
            
            .users-table th,
            .users-table td {
                padding: 10px 8px;
                font-size: 13px;
            }
        }
    </style>
</head>
<body>
    <!-- Login Page -->
    <div class="login-page" id="login-page">
        <div class="login-container">
            <div class="login-logo">
                <div class="login-logo-img">
                    <img src="image/Cream & Black Aesthetic Cake & Dessert Logo.png" alt="Sweet Delights Cake Logo">
                </div>
                <h1 class="login-title">Sweet Delights</h1>
            </div>
            
            <div class="login-tabs">
                <button class="login-tab active" data-role="customer">Customer</button>
                <button class="login-tab" data-role="staff">Staff</button>
                <button class="login-tab" data-role="admin">Admin</button>
            </div>
            
            <form id="login-form">
                <div class="form-group suggestions-container">
                    <label for="login-username">Username</label>
                    <input type="text" id="login-username" required autocomplete="off">
                    <div class="suggestions-list" id="username-suggestions">
                        <!-- Suggestions will be dynamically added here -->
                    </div>
                </div>
                <div class="form-group">
                    <label for="login-password">Password</label>
                    <div class="password-container">
                        <input type="password" id="login-password" required>
                        <button type="button" class="toggle-password" id="toggle-login-password">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                <div id="login-error" class="login-error"></div>
                <button type="submit" class="checkout-btn">
                    <i class="fas fa-sign-in-alt"></i>
                    Login
                </button>
            </form>
        </div>
    </div>

    <!-- Dashboard (Hidden by default) -->
    <div class="dashboard" id="dashboard">
        <header>
            <div class="container">
                <div class="header-content">
                    <div class="logo">
                        <div class="logo-img">
                            <img src="image/Cream & Black Aesthetic Cake & Dessert Logo.png" alt="Sweet Delights Cake Logo">
                        </div>
                        <span>Sweet Delights</span>
                    </div>
                    <div class="user-info">
                        <div class="user-details">
                            <span id="current-user">Customer User</span>
                            <span class="user-type" id="user-role">Customer</span>
                        </div>
                        <button class="btn" id="logout-btn">
                            <i class="fas fa-sign-out-alt"></i>
                            Logout
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <nav>
            <div class="container nav-container">
                <div class="nav-section" id="customer-nav">
                    <button class="nav-btn active" data-section="browse-menu">
                        <i class="fas fa-utensils"></i>
                        Browse Menu
                    </button>
                    <button class="nav-btn" data-section="cart">
                        <i class="fas fa-shopping-cart"></i>
                        Cart
                        <span id="cart-count" class="badge">0</span>
                    </button>
                    <button class="nav-btn" data-section="track-order">
                        <i class="fas fa-truck"></i>
                        Track Order
                    </button>
                    <button class="nav-btn" data-section="order-history">
                        <i class="fas fa-history"></i>
                        Order History
                    </button>
                    <button class="nav-btn" data-section="about-us">
                        <i class="fas fa-info-circle"></i>
                        About Us
                    </button>
                </div>
                <div class="nav-section" id="staff-nav">
                    <button class="nav-btn" data-section="view-orders">
                        <i class="fas fa-clipboard-list"></i>
                        View Orders
                    </button>
                </div>
                <div class="nav-section" id="admin-nav">
                    <button class="nav-btn" data-section="manage-menu">
                        <i class="fas fa-concierge-bell"></i>
                        Manage Menu
                    </button>
                    <button class="nav-btn" data-section="manage-users">
                        <i class="fas fa-users-cog"></i>
                        Manage Users
                    </button>
                </div>
            </div>
        </nav>

        <div class="container">
            <div class="content">
                <div class="main-content">
                    <!-- Browse Menu Section -->
                    <div id="browse-menu" class="section active">
                        <h2 class="section-title"><i class="fas fa-utensils"></i> Our Cake Menu</h2>
                        <div class="menu-grid" id="menu-items">
                            <!-- Menu items will be dynamically added here -->
                        </div>
                    </div>

                    <!-- Cart Section -->
                    <div id="cart" class="section">
                        <h2 class="section-title"><i class="fas fa-shopping-cart"></i> Your Cart</h2>
                        <div class="cart-cards" id="cart-cards">
                            <!-- Cart cards will be dynamically added here -->
                        </div>
                        <div class="cart-summary">
                            <div class="cart-total" id="cart-total">Total: ₱0.00</div>
                            <button class="checkout-btn" id="proceed-to-payment">
                                <i class="fas fa-credit-card"></i>
                                Proceed to Payment
                            </button>
                        </div>
                    </div>

                    <!-- Payment Section -->
                    <div id="payment" class="section">
                        <h2 class="section-title"><i class="fas fa-credit-card"></i> Payment</h2>
                        <div class="payment-container">
                            <div class="payment-methods-container">
                                <h3 style="margin-bottom: 20px; color: var(--dark);">Select Payment Method</h3>
                                <div class="payment-methods">
                                    <div class="payment-method gcash-payment" data-method="gcash">
                                        <div class="gcash-logo">
                                            <img src="image/gcash logo.jpg" alt="GCash Logo">
                                        </div>
                                        <div>GCash</div>
                                    </div>
                                    <div class="payment-method" data-method="cod">
                                        <div class="payment-icon">
                                            <i class="fas fa-money-bill-wave"></i>
                                        </div>
                                        <div>Cash on Delivery</div>
                                    </div>
                                </div>

                                <!-- Contact Information for both payment methods -->
                                <div class="contact-info-payment">
                                    <div class="form-group">
                                        <label for="customer-name">Full Name</label>
                                        <input type="text" id="customer-name" placeholder="Enter your full name" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="customer-contact">Contact Number</label>
                                        <input type="text" id="customer-contact" placeholder="09XX XXX XXXX" maxlength="11" required>
                                    </div>
                                </div>

                                <!-- Single Line Location Input -->
                                <div class="form-group">
                                    <label for="delivery-location">Delivery Address</label>
                                    <input type="text" id="delivery-location" class="single-line-location" 
                                           placeholder="House/Building No., Street, Barangay, City, Province, ZIP Code" required>
                                </div>

                                <!-- GCash Payment Form -->
                                <div id="gcash-payment-form" style="display: none;">
                                    <h3 style="margin-bottom: 20px; color: var(--dark);">GCash Payment</h3>
                                    <div class="gcash-instructions">
                                        <h4><i class="fas fa-info-circle"></i> How to Pay with GCash:</h4>
                                        <ol>
                                            <li>Open your GCash app</li>
                                            <li>Go to "Send Money"</li>
                                            <li>Enter our GCash number: <strong>0917 123 4567</strong></li>
                                            <li>Enter the amount: <strong id="gcash-amount">₱0.00</strong></li>
                                            <li>Add your order ID in the message: <strong id="gcash-order-id">#1001</strong></li>
                                            <li>Confirm the payment</li>
                                        </ol>
                                        <p><strong>Note:</strong> Your order will be processed once payment is confirmed.</p>
                                    </div>
                                </div>

                                <!-- COD Payment Form -->
                                <div id="cod-info" style="display: none;">
                                    <h3 style="margin-bottom: 20px; color: var(--dark);">Cash on Delivery</h3>
                                    <p>Pay with cash when your order is delivered to your address.</p>
                                </div>
                            </div>
                            <div class="payment-form-container">
                                <h3 style="margin-bottom: 20px; color: var(--dark);">Order Summary</h3>
                                <div id="payment-summary">
                                    <!-- Order summary will be dynamically added here -->
                                </div>
                                <div class="cart-total" id="payment-total">Total: ₱0.00</div>
                                <button class="checkout-btn" id="confirm-gcash-payment" style="display: none;">
                                    <i class="fas fa-check"></i>
                                    Confirm GCash Payment
                                </button>
                                <button class="checkout-btn" id="complete-cod-payment" style="display: none;">
                                    <i class="fas fa-check"></i>
                                    Place COD Order
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Track Order Section -->
                    <div id="track-order" class="section">
                        <h2 class="section-title"><i class="fas fa-truck"></i> Track Your Orders</h2>
                        <div class="tracking-container" id="order-tracking-container">
                            <!-- Order tracking cards will be dynamically added here -->
                        </div>
                        <div class="tracking-summary">
                            <h3 style="margin-bottom: 20px; color: var(--dark);">Tracking Summary</h3>
                            <div id="tracking-summary">
                                <!-- Tracking summary will be dynamically added here -->
                            </div>
                        </div>
                    </div>

                    <!-- Order History Section -->
                    <div id="order-history" class="section">
                        <h2 class="section-title"><i class="fas fa-history"></i> Order History</h2>
                        <div class="order-history-cards" id="order-history-cards">
                            <!-- Order history cards will be dynamically added here -->
                        </div>
                        <!-- Empty state message -->
                        <div id="order-history-empty" class="order-history-empty">
                            <p>You have no order history yet.</p>
                        </div>
                    </div>

                    <!-- About Us Section -->
                    <div id="about-us" class="section">
                        <h2 class="section-title"><i class="fas fa-info-circle"></i> About Sweet Delights</h2>
                        
                        <div class="mission-vision">
                            <div class="mission-card">
                                <h3><i class="fas fa-bullseye" style="color: var(--primary);"></i> Our Mission</h3>
                                <p>To create exceptional cake and dessert experiences by crafting each product with passion, quality ingredients, and heartfelt dedication. We strive to make every celebration sweeter through our made-with-love approach to baking and customer service.</p>
                            </div>
                            
                            <div class="vision-card">
                                <h3><i class="fas fa-eye" style="color: var(--secondary);"></i> Our Vision</h3>
                                <p>To become the most beloved cake and dessert destination in our community, recognized for our commitment to quality, creativity, and the genuine care we put into every product we create. We envision spreading joy and creating lasting memories through our delicious creations.</p>
                            </div>
                        </div>
                        
                        <div style="background-color: white; border-radius: 12px; padding: 30px; box-shadow: var(--shadow);">
                            <h3 style="margin-bottom: 20px; color: var(--dark); display: flex; align-items: center; gap: 10px;">
                                <i class="fas fa-heart" style="color: var(--primary);"></i> Our Story
                            </h3>
                            <p style="line-height: 1.7; color: var(--gray); margin-bottom: 20px;">
                                Sweet Delights was founded with a simple yet powerful idea: to bring joy to people's lives through beautifully crafted, delicious cakes and desserts. Our journey began in a small home kitchen, where every cake was baked with love and attention to detail.
                            </p>
                            <p style="line-height: 1.7; color: var(--gray);">
                                Today, we continue to honor that tradition, using only the finest ingredients and maintaining our commitment to quality and customer satisfaction. Every cake we create carries our signature "MADE WITH LOVE" promise, ensuring that your special moments become even more memorable.
                            </p>
                        </div>
                        
                        <!-- Contact Information -->
                        <div class="contact-info">
                            <h3><i class="fas fa-address-book" style="color: var(--primary);"></i> Contact Us</h3>
                            <div class="contact-details">
                                <div class="contact-item">
                                    <div class="contact-icon">
                                        <i class="fas fa-map-marker-alt"></i>
                                    </div>
                                    <div>
                                        <h4>Address</h4>
                                        <p>123 Sweet Street, Dessert City</p>
                                    </div>
                                </div>
                                <div class="contact-item">
                                    <div class="contact-icon">
                                        <i class="fas fa-phone"></i>
                                    </div>
                                    <div>
                                        <h4>Phone</h4>
                                        <p>09626184836</p>
                                    </div>
                                </div>
                                <div class="contact-item">
                                    <div class="contact-icon">
                                        <i class="fas fa-envelope"></i>
                                    </div>
                                    <div>
                                        <h4>Email</h4>
                                        <p>datinguinoojustin153@gmail.com</p>
                                    </div>
                                </div>
                                <div class="contact-item">
                                    <div class="contact-icon">
                                        <i class="fas fa-clock"></i>
                                    </div>
                                    <div>
                                        <h4>Business Hours</h4>
                                        <p>Mon-Sat: 8AM - 8PM</p>
                                        <p>Sunday: 9AM - 6PM</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- View Orders Section (Staff) -->
                    <div id="view-orders" class="section">
                        <h2 class="section-title"><i class="fas fa-clipboard-list"></i> All Orders</h2>
                        <table class="action-table">
                            <thead>
                                <tr>
                                    <th>Order ID</th>
                                    <th>Customer</th>
                                    <th>Items</th>
                                    <th>Total</th>
                                    <th>Payment</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="orders-table-body">
                                <!-- Orders will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>

                    <!-- Manage Menu Section (Admin) -->
                    <div id="manage-menu" class="section">
                        <h2 class="section-title"><i class="fas fa-concierge-bell"></i> Manage Menu Items</h2>
                        <button class="btn" id="add-new-item">
                            <i class="fas fa-plus"></i>
                            Add New Item
                        </button>
                        <table id="menu-table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Description</th>
                                    <th>Price</th>
                                    <th>Image</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Menu items will be dynamically added here -->
                            </tbody>
                        </table>
                    </div>

                    <!-- Manage Users Section (Admin) -->
                    <div id="manage-users" class="section">
                        <h2 class="section-title"><i class="fas fa-users-cog"></i> Manage Users</h2>
                        <div class="users-table-container">
                            <button class="btn" id="add-new-user">
                                <i class="fas fa-user-plus"></i>
                                Add New User
                            </button>
                            <table class="users-table">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Username</th>
                                        <th>Role</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="users-list">
                                    <!-- Users will be dynamically added here -->
                                </tbody>
                            </table>
                        </div>
                        <div class="users-summary">
                            <h3 style="margin-bottom: 20px; color: var(--dark);">Users Summary</h3>
                            <div id="users-summary">
                                <!-- Users summary will be dynamically added here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer>
            <div class="container">
                <div class="footer-bottom">
                    <p>&copy; 2023 Sweet Delights. All rights reserved. | Made with <i class="fas fa-heart" style="color: var(--primary);"></i></p>
                </div>
            </div>
        </footer>
    </div>

    <!-- Menu Item Modal -->
    <div class="modal" id="menu-item-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="menu-modal-title">Add Menu Item</h3>
                <button class="close-modal" id="close-menu-modal">&times;</button>
            </div>
            <form id="menu-item-form">
                <input type="hidden" id="menu-item-id">
                <div class="form-group">
                    <label for="menu-item-name">Item Name</label>
                    <input type="text" id="menu-item-name" required>
                </div>
                <div class="form-group">
                    <label for="menu-item-description">Description</label>
                    <textarea id="menu-item-description" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label for="menu-item-price">Price (₱)</label>
                    <input type="number" id="menu-item-price" step="0.01" min="0" required>
                </div>
                <div class="form-group">
                    <label for="menu-item-image-url">Item Image URL</label>
                    <input type="text" id="menu-item-image-url" placeholder="Enter image URL">
                </div>
                <div class="modal-actions">
                    <button type="button" class="modal-btn modal-btn-secondary" id="cancel-menu-item">Cancel</button>
                    <button type="submit" class="modal-btn modal-btn-primary">Save Item</button>
                </div>
            </form>
        </div>
    </div>

    <!-- User Modal -->
    <div class="modal" id="user-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="user-modal-title">Add User</h3>
                <button class="close-modal" id="close-user-modal">&times;</button>
            </div>
            <form id="user-form">
                <input type="hidden" id="user-id">
                <div class="form-group">
                    <label for="user-name">Name</label>
                    <input type="text" id="user-name" required>
                </div>
                <div class="form-group">
                    <label for="user-username">Username</label>
                    <input type="text" id="user-username" required>
                </div>
                <div class="form-group">
                    <label for="user-password">Password</label>
                    <div class="password-container">
                        <input type="password" id="user-password" required>
                        <button type="button" class="toggle-password" id="toggle-user-password">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                <div class="form-group">
                    <label for="user-role">Role</label>
                    <select id="user-role" required>
                        <option value="customer">Customer</option>
                        <option value="staff">Staff</option>
                        <option value="admin">Admin</option>
                    </select>
                </div>
                <div class="modal-actions">
                    <button type="button" class="modal-btn modal-btn-secondary" id="cancel-user">Cancel</button>
                    <button type="submit" class="modal-btn modal-btn-primary">Save User</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Cancel Order Confirmation Modal -->
    <div class="modal cancel-confirmation-modal" id="cancel-order-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Cancel Order</h3>
                <button class="close-modal" id="close-cancel-modal">&times;</button>
            </div>
            <div class="cancel-confirmation">
                <p>Are you sure you want to cancel this order? This action cannot be undone.</p>
                <div class="cancel-reason">
                    <label for="cancel-reason">Reason for cancellation (optional):</label>
                    <textarea id="cancel-reason" placeholder="Please provide a reason for cancellation..."></textarea>
                </div>
                <div class="modal-actions">
                    <button type="button" class="modal-btn modal-btn-secondary" id="cancel-cancel-order">No, Keep Order</button>
                    <button type="button" class="modal-btn modal-btn-danger" id="confirm-cancel-order">Yes, Cancel Order</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Sample data with image references
        let menuItems = [
            { 
                id: 1, 
                name: "Chocolate Fudge Cake", 
                description: "Rich chocolate cake with fudge frosting", 
                price: 1299.99, 
                image: "image/choco.jpg"
            },
            { 
                id: 2, 
                name: "Vanilla Bean Cake", 
                description: "Classic vanilla cake with buttercream", 
                price: 1149.99, 
                image: "image/vanila.jpg" 
            },
            { 
                id: 3, 
                name: "Red Velvet Cake", 
                description: "Moist red velvet with cream cheese frosting", 
                price: 1449.99, 
                image: "image/red velvet.jpg" 
            },
            { 
                id: 4, 
                name: "Carrot Cake", 
                description: "Spiced carrot cake with cream cheese frosting", 
                price: 1249.99, 
                image: "image/Carrot-Cake-14-Edit.jpg" 
            },
            { 
                id: 5, 
                name: "Lemon Drizzle Cake", 
                description: "Zesty lemon cake with lemon glaze", 
                price: 1099.99, 
                image: "image/lemon-drizzle-cake-recipe-serving.webp" 
            },
            { 
                id: 6, 
                name: "Strawberry Shortcake", 
                description: "Light sponge with fresh strawberries", 
                price: 1349.99, 
                image: "image/Strawberry-shortcake-cake-1-of-1.jpg" 
            }
        ];

        let cart = [];
        let orders = [];
        let orderHistory = [];
        let users = [
            { id: 1, name: "Customer User", role: "customer", username: "customer", password: "customer123" },
            { id: 2, name: "Staff User", role: "staff", username: "staff", password: "staff123" },
            { id: 3, name: "Admin User", role: "admin", username: "admin", password: "admin123" }
        ];

        let currentUser = null;
        let currentOrderId = 1001;
        let nextMenuItemId = 7;
        let nextUserId = 4;
        let selectedLoginRole = 'customer';
        let userLocation = null;
        let map = null;
        let routeLayer = null;
        let orderToCancel = null;

        // DOM Elements
        const loginPage = document.getElementById('login-page');
        const dashboard = document.getElementById('dashboard');
        const loginForm = document.getElementById('login-form');
        const loginUsername = document.getElementById('login-username');
        const loginPassword = document.getElementById('login-password');
        const loginError = document.getElementById('login-error');
        const loginTabs = document.querySelectorAll('.login-tab');
        const toggleLoginPassword = document.getElementById('toggle-login-password');
        const logoutBtn = document.getElementById('logout-btn');
        const usernameSuggestions = document.getElementById('username-suggestions');

        const currentUserElement = document.getElementById('current-user');
        const userRoleElement = document.getElementById('user-role');
        const navButtons = document.querySelectorAll('.nav-btn');
        const sections = document.querySelectorAll('.section');
        const menuItemsContainer = document.getElementById('menu-items');
        const cartCardsContainer = document.getElementById('cart-cards');
        const cartTotalElement = document.getElementById('cart-total');
        const cartCountElement = document.getElementById('cart-count');
        const proceedToPaymentButton = document.getElementById('proceed-to-payment');
        const paymentMethods = document.querySelectorAll('.payment-method');
        const gcashPaymentForm = document.getElementById('gcash-payment-form');
        const codInfo = document.getElementById('cod-info');
        const ordersTableBody = document.getElementById('orders-table-body');
        const menuTableBody = document.querySelector('#menu-table tbody');
        const usersList = document.getElementById('users-list');
        const orderTrackingContainer = document.getElementById('order-tracking-container');
        const gcashAmountElement = document.getElementById('gcash-amount');
        const gcashOrderIdElement = document.getElementById('gcash-order-id');
        const confirmGcashPaymentButton = document.getElementById('confirm-gcash-payment');
        const completeCodPaymentButton = document.getElementById('complete-cod-payment');
        const paymentSummaryElement = document.getElementById('payment-summary');
        const paymentTotalElement = document.getElementById('payment-total');
        const trackingSummaryElement = document.getElementById('tracking-summary');
        const usersSummaryElement = document.getElementById('users-summary');
        
        // Order History Elements
        const orderHistoryCardsContainer = document.getElementById('order-history-cards');
        const orderHistoryEmpty = document.getElementById('order-history-empty');
        
        // New form elements
        const customerNameInput = document.getElementById('customer-name');
        const customerContactInput = document.getElementById('customer-contact');
        const deliveryLocationInput = document.getElementById('delivery-location');
        
        // Modal Elements
        const menuItemModal = document.getElementById('menu-item-modal');
        const menuModalTitle = document.getElementById('menu-modal-title');
        const menuItemForm = document.getElementById('menu-item-form');
        const menuItemId = document.getElementById('menu-item-id');
        const menuItemName = document.getElementById('menu-item-name');
        const menuItemDescription = document.getElementById('menu-item-description');
        const menuItemPrice = document.getElementById('menu-item-price');
        const menuItemImageUrl = document.getElementById('menu-item-image-url');
        const closeMenuModal = document.getElementById('close-menu-modal');
        const cancelMenuItem = document.getElementById('cancel-menu-item');
        const addNewItemButton = document.getElementById('add-new-item');
        
        // User Modal Elements
        const userModal = document.getElementById('user-modal');
        const userModalTitle = document.getElementById('user-modal-title');
        const userForm = document.getElementById('user-form');
        const userId = document.getElementById('user-id');
        const userName = document.getElementById('user-name');
        const userUsername = document.getElementById('user-username');
        const userPassword = document.getElementById('user-password');
        const userRole = document.getElementById('user-role');
        const closeUserModal = document.getElementById('close-user-modal');
        const cancelUser = document.getElementById('cancel-user');
        const addNewUserButton = document.getElementById('add-new-user');
        const toggleUserPassword = document.getElementById('toggle-user-password');

        // Cancel Order Modal Elements
        const cancelOrderModal = document.getElementById('cancel-order-modal');
        const closeCancelModal = document.getElementById('close-cancel-modal');
        const cancelCancelOrder = document.getElementById('cancel-cancel-order');
        const confirmCancelOrder = document.getElementById('confirm-cancel-order');
        const cancelReason = document.getElementById('cancel-reason');

        // Enhanced Username Storage Functions
        function getStoredUsernames() {
            const stored = localStorage.getItem('sweetDelightsUsernames');
            return stored ? JSON.parse(stored) : {};
        }

        function saveUsername(role, username) {
            const stored = getStoredUsernames();
            if (!stored[role]) {
                stored[role] = [];
            }
            
            // Add username if not already in the list
            if (!stored[role].includes(username)) {
                stored[role].push(username);
                localStorage.setItem('sweetDelightsUsernames', JSON.stringify(stored));
            }
        }

        function showUsernameSuggestions() {
            const stored = getStoredUsernames();
            const roleUsernames = stored[selectedLoginRole] || [];
            const suggestionsList = document.getElementById('username-suggestions');
            
            suggestionsList.innerHTML = '';
            
            if (roleUsernames.length === 0) {
                const noSuggestions = document.createElement('div');
                noSuggestions.className = 'no-suggestions';
                noSuggestions.textContent = 'No saved usernames for this role';
                suggestionsList.appendChild(noSuggestions);
                suggestionsList.style.display = 'block';
                return;
            }
            
            // Add header
            const header = document.createElement('div');
            header.className = 'suggestions-header';
            header.textContent = `Recent ${selectedLoginRole} usernames:`;
            suggestionsList.appendChild(header);
            
            // Create suggestion items (show most recent first)
            roleUsernames.slice().reverse().forEach(username => {
                const suggestionItem = document.createElement('div');
                suggestionItem.className = 'suggestion-item recent';
                suggestionItem.innerHTML = `
                    <div class="suggestion-icon">
                        <i class="fas fa-history"></i>
                    </div>
                    <div class="suggestion-username">${username}</div>
                    <div class="suggestion-role">${selectedLoginRole}</div>
                `;
                suggestionItem.addEventListener('click', () => {
                    loginUsername.value = username;
                    suggestionsList.style.display = 'none';
                });
                suggestionsList.appendChild(suggestionItem);
            });
            
            suggestionsList.style.display = 'block';
        }

        // Add keyboard navigation for suggestions
        function setupKeyboardNavigation() {
            let highlightedIndex = -1;
            const suggestionsList = document.getElementById('username-suggestions');
            
            loginUsername.addEventListener('keydown', (e) => {
                if (!suggestionsList.style.display || suggestionsList.style.display === 'none') {
                    return;
                }
                
                const items = suggestionsList.querySelectorAll('.suggestion-item:not(.no-suggestions)');
                
                switch(e.key) {
                    case 'ArrowDown':
                        e.preventDefault();
                        highlightedIndex = (highlightedIndex + 1) % items.length;
                        updateHighlightedItem(items, highlightedIndex);
                        break;
                        
                    case 'ArrowUp':
                        e.preventDefault();
                        highlightedIndex = (highlightedIndex - 1 + items.length) % items.length;
                        updateHighlightedItem(items, highlightedIndex);
                        break;
                        
                    case 'Enter':
                        e.preventDefault();
                        if (highlightedIndex >= 0 && items[highlightedIndex]) {
                            loginUsername.value = items[highlightedIndex].querySelector('.suggestion-username').textContent;
                            suggestionsList.style.display = 'none';
                            highlightedIndex = -1;
                        }
                        break;
                        
                    case 'Escape':
                        suggestionsList.style.display = 'none';
                        highlightedIndex = -1;
                        break;
                }
            });
            
            function updateHighlightedItem(items, index) {
                items.forEach((item, i) => {
                    if (i === index) {
                        item.classList.add('highlighted');
                        // Scroll into view if needed
                        item.scrollIntoView({ block: 'nearest' });
                    } else {
                        item.classList.remove('highlighted');
                    }
                });
            }
        }

        // Filter suggestions based on input
        function filterSuggestions() {
            const input = loginUsername.value.toLowerCase();
            const suggestionsList = document.getElementById('username-suggestions');
            const suggestionItems = suggestionsList.querySelectorAll('.suggestion-item');
            
            let hasVisibleItems = false;
            
            suggestionItems.forEach(item => {
                if (item.classList.contains('suggestions-header') || item.classList.contains('no-suggestions')) {
                    return;
                }
                
                const username = item.querySelector('.suggestion-username').textContent.toLowerCase();
                if (username.includes(input)) {
                    item.style.display = 'flex';
                    hasVisibleItems = true;
                } else {
                    item.style.display = 'none';
                }
            });
            
            // Show/hide header based on visibility
            const header = suggestionsList.querySelector('.suggestions-header');
            if (header) {
                header.style.display = hasVisibleItems ? 'block' : 'none';
            }
            
            // Show no results message if no matches
            const noSuggestions = suggestionsList.querySelector('.no-suggestions');
            if (!hasVisibleItems && input.length > 0) {
                if (!noSuggestions) {
                    const noResults = document.createElement('div');
                    noResults.className = 'no-suggestions';
                    noResults.textContent = 'No matching usernames';
                    suggestionsList.appendChild(noResults);
                }
            } else if (noSuggestions) {
                noSuggestions.remove();
            }
        }

        // Initialize the application
        function init() {
            setupEventListeners();
            renderMenuItems();
            updateCartCount();
            setupKeyboardNavigation();
            
            // Set initial order ID for GCash
            gcashOrderIdElement.textContent = `#${currentOrderId}`;
            
            // Move any existing delivered orders to history
            moveDeliveredOrdersToHistory();
        }

        // Render menu items
        function renderMenuItems() {
            menuItemsContainer.innerHTML = '';
            
            menuItems.forEach(item => {
                const menuItem = document.createElement('div');
                menuItem.className = 'menu-item';
                menuItem.innerHTML = `
                    <div class="menu-item-img">
                        <img src="${item.image}" alt="${item.name}">
                    </div>
                    <div class="menu-item-content">
                        <h3 class="menu-item-title">${item.name}</h3>
                        <p class="menu-item-desc">${item.description}</p>
                        <div class="menu-item-footer">
                            <div class="price">₱${item.price.toFixed(2)}</div>
                            <button class="add-to-cart" data-id="${item.id}">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>
                `;
                menuItemsContainer.appendChild(menuItem);
            });
        }

        // Update UI based on current user
        function updateUserInterface() {
            currentUserElement.textContent = currentUser.name;
            userRoleElement.textContent = currentUser.role.charAt(0).toUpperCase() + currentUser.role.slice(1);
            
            // Show/hide navigation based on user role
            document.getElementById('customer-nav').style.display = currentUser.role === 'customer' ? 'flex' : 'none';
            document.getElementById('staff-nav').style.display = currentUser.role === 'staff' ? 'flex' : 'none';
            document.getElementById('admin-nav').style.display = currentUser.role === 'admin' ? 'flex' : 'none';
            
            // Reset to default section based on user role
            if (currentUser.role === 'customer') {
                showSection('browse-menu');
            } else if (currentUser.role === 'staff') {
                showSection('view-orders');
                renderOrdersTable();
            } else if (currentUser.role === 'admin') {
                showSection('manage-menu');
                renderMenuTable();
                renderUsersList();
            }
        }

        // Update login tabs
        function updateLoginTabs() {
            loginTabs.forEach(tab => {
                if (tab.getAttribute('data-role') === selectedLoginRole) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });
        }

        // Show a specific section
        function showSection(sectionId) {
            sections.forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');
            
            navButtons.forEach(button => {
                button.classList.remove('active');
                if (button.getAttribute('data-section') === sectionId) {
                    button.classList.add('active');
                }
            });
            
            // Load appropriate content for the section
            if (sectionId === 'cart') {
                renderCart();
            } else if (sectionId === 'payment') {
                renderPaymentSummary();
            } else if (sectionId === 'view-orders') {
                renderOrdersTable();
            } else if (sectionId === 'manage-menu') {
                renderMenuTable();
            } else if (sectionId === 'manage-users') {
                renderUsersList();
            } else if (sectionId === 'track-order') {
                renderOrderTracking();
                renderTrackingSummary();
            } else if (sectionId === 'order-history') {
                moveDeliveredOrdersToHistory();
                renderOrderHistory();
            }
        }

        // Render cart as vertical cards
        function renderCart() {
            cartCardsContainer.innerHTML = '';
            
            if (cart.length === 0) {
                cartCardsContainer.innerHTML = '<div class="cart-empty">Your cart is empty</div>';
                cartTotalElement.textContent = 'Total: ₱0.00';
                return;
            }
            
            let total = 0;
            cart.forEach(item => {
                const subtotal = item.price * item.quantity;
                total += subtotal;
                
                const cartCard = document.createElement('div');
                cartCard.className = 'cart-card';
                cartCard.innerHTML = `
                    <div class="cart-item-img">
                        <img src="${menuItems.find(menuItem => menuItem.id === item.id).image}" alt="${item.name}">
                    </div>
                    <div class="cart-item-details">
                        <div class="cart-item-name">${item.name}</div>
                        <div class="cart-item-price">₱${item.price.toFixed(2)}</div>
                        <div class="cart-item-controls">
                            <button class="quantity-btn decrease-quantity" data-id="${item.id}">
                                <i class="fas fa-minus"></i>
                            </button>
                            <span>${item.quantity}</span>
                            <button class="quantity-btn increase-quantity" data-id="${item.id}">
                                <i class="fas fa-plus"></i>
                            </button>
                            <button class="remove-btn" data-id="${item.id}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <div class="cart-item-subtotal">₱${subtotal.toFixed(2)}</div>
                `;
                cartCardsContainer.appendChild(cartCard);
            });
            
            cartTotalElement.textContent = `Total: ₱${total.toFixed(2)}`;
            gcashAmountElement.textContent = `₱${total.toFixed(2)}`;
        }

        // Render payment summary
        function renderPaymentSummary() {
            paymentSummaryElement.innerHTML = '';
            
            if (cart.length === 0) {
                paymentSummaryElement.innerHTML = '<p>Your cart is empty</p>';
                paymentTotalElement.textContent = 'Total: ₱0.00';
                return;
            }
            
            let total = 0;
            cart.forEach(item => {
                const paymentItemElement = document.createElement('div');
                paymentItemElement.className = 'cart-item';
                paymentItemElement.innerHTML = `
                    <div class="cart-item-info">
                        <h4>${item.name}</h4>
                        <div class="cart-item-price">₱${item.price.toFixed(2)}</div>
                    </div>
                    <div class="cart-item-controls">
                        <span>Qty: ${item.quantity}</span>
                    </div>
                `;
                paymentSummaryElement.appendChild(paymentItemElement);
                total += item.price * item.quantity;
            });
            
            paymentTotalElement.textContent = `Total: ₱${total.toFixed(2)}`;
        }

        // Update cart count in navigation
        function updateCartCount() {
            const count = cart.reduce((total, item) => total + item.quantity, 0);
            cartCountElement.textContent = count;
        }

        // Render orders table for staff
        function renderOrdersTable() {
            ordersTableBody.innerHTML = '';
            
            if (orders.length === 0) {
                ordersTableBody.innerHTML = '<tr><td colspan="7">No orders found</td></tr>';
                return;
            }
            
            orders.forEach(order => {
                const orderRow = document.createElement('tr');
                orderRow.innerHTML = `
                    <td>#${order.id}</td>
                    <td>${order.customerName || order.customer}</td>
                    <td>${order.items.map(item => `${item.name} (${item.quantity})`).join(', ')}</td>
                    <td>₱${order.total.toFixed(2)}</td>
                    <td>${order.paymentMethod}</td>
                    <td><span class="status-badge status-${order.status}">${order.status.charAt(0).toUpperCase() + order.status.slice(1)}</span></td>
                    <td>
                        <select class="status-select update-status" data-id="${order.id}">
                            <option value="pending" ${order.status === 'pending' ? 'selected' : ''}>Pending</option>
                            <option value="preparing" ${order.status === 'preparing' ? 'selected' : ''}>Preparing</option>
                            <option value="ready" ${order.status === 'ready' ? 'selected' : ''}>Ready</option>
                            <option value="delivered" ${order.status === 'delivered' ? 'selected' : ''}>Delivered</option>
                        </select>
                    </td>
                `;
                ordersTableBody.appendChild(orderRow);
            });
        }

        // Render menu table for admin
        function renderMenuTable() {
            menuTableBody.innerHTML = '';
            
            menuItems.forEach(item => {
                const menuRow = document.createElement('tr');
                menuRow.innerHTML = `
                    <td>${item.name}</td>
                    <td>${item.description}</td>
                    <td>₱${item.price.toFixed(2)}</td>
                    <td><img src="${item.image}" alt="${item.name}" style="width: 50px; height: 50px; object-fit: cover; border-radius: 5px;"></td>
                    <td>
                        <button class="action-btn edit-btn edit-item" data-id="${item.id}">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="action-btn delete-btn delete-item" data-id="${item.id}">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                menuTableBody.appendChild(menuRow);
            });
        }

        // Render users list for admin as table
        function renderUsersList() {
            usersList.innerHTML = '';
            
            users.forEach(user => {
                const userRow = document.createElement('tr');
                userRow.innerHTML = `
                    <td>${user.name}</td>
                    <td>${user.username}</td>
                    <td>${user.role.charAt(0).toUpperCase() + user.role.slice(1)}</td>
                    <td>
                        <div class="user-actions">
                            <button class="action-btn edit-btn edit-user" data-id="${user.id}">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn delete-btn delete-user" data-id="${user.id}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;
                usersList.appendChild(userRow);
            });
            
            // Update users summary
            renderUsersSummary();
        }

        // Render users summary
        function renderUsersSummary() {
            const customerCount = users.filter(user => user.role === 'customer').length;
            const staffCount = users.filter(user => user.role === 'staff').length;
            const adminCount = users.filter(user => user.role === 'admin').length;
            
            usersSummaryElement.innerHTML = `
                <div style="margin-bottom: 15px;">
                    <h4 style="color: var(--dark); margin-bottom: 5px;">Total Users</h4>
                    <p style="font-size: 24px; font-weight: bold; color: var(--primary);">${users.length}</p>
                </div>
                <div style="margin-bottom: 15px;">
                    <h4 style="color: var(--dark); margin-bottom: 5px;">Customers</h4>
                    <p style="font-size: 18px; color: var(--secondary);">${customerCount}</p>
                </div>
                <div style="margin-bottom: 15px;">
                    <h4 style="color: var(--dark); margin-bottom: 5px;">Staff</h4>
                    <p style="font-size: 18px; color: var(--accent);">${staffCount}</p>
                </div>
                <div style="margin-bottom: 15px;">
                    <h4 style="color: var(--dark); margin-bottom: 5px;">Admins</h4>
                    <p style="font-size: 18px; color: var(--primary);">${adminCount}</p>
                </div>
            `;
        }

        // Render order tracking as cards
        function renderOrderTracking() {
            const trackingContainer = document.getElementById('order-tracking-container');
            trackingContainer.innerHTML = '';
            
            if (orders.length === 0) {
                trackingContainer.innerHTML = '<div class="order-card" style="text-align: center; padding: 40px;">You have no orders yet.</div>';
                return;
            }
            
            // Show all orders, with the most recent first
            orders.reverse().forEach(order => {
                const orderCard = document.createElement('div');
                orderCard.className = 'order-card';
                
                // Calculate progress based on status
                let progressWidth = '0%';
                let completedSteps = 0;
                
                if (order.status === 'pending') {
                    progressWidth = '0%';
                    completedSteps = 0;
                } else if (order.status === 'preparing') {
                    progressWidth = '33%';
                    completedSteps = 1;
                } else if (order.status === 'ready') {
                    progressWidth = '66%';
                    completedSteps = 2;
                } else if (order.status === 'delivered') {
                    progressWidth = '100%';
                    completedSteps = 3;
                } else if (order.status === 'cancelled') {
                    progressWidth = '0%';
                    completedSteps = 0;
                }
                
                // Set the CSS variable for the progress bar animation
                orderCard.style.setProperty('--progress-width', progressWidth);
                
                orderCard.innerHTML = `
                    <div class="order-header">
                        <div>
                            <div class="order-id">Order #${order.id}</div>
                            <div class="order-date">${order.date}</div>
                        </div>
                        <div class="order-status status-${order.status}">${order.status.charAt(0).toUpperCase() + order.status.slice(1)}</div>
                    </div>
                    <div class="order-details">
                        <div class="order-detail-row">
                            <div class="order-detail-label">Items:</div>
                            <div class="order-detail-value">${order.items.map(item => `${item.name} (${item.quantity})`).join(', ')}</div>
                        </div>
                        <div class="order-detail-row">
                            <div class="order-detail-label">Total:</div>
                            <div class="order-detail-value">₱${order.total.toFixed(2)}</div>
                        </div>
                        <div class="order-detail-row">
                            <div class="order-detail-label">Payment Method:</div>
                            <div class="order-detail-value">${order.paymentMethod}</div>
                        </div>
                        <div class="order-detail-row">
                            <div class="order-detail-label">Delivery Address:</div>
                            <div class="order-detail-value">${order.location}</div>
                        </div>
                    </div>
                    ${order.status !== 'cancelled' && order.status !== 'delivered' ? `
                    <div class="tracking-progress">
                        <div class="progress-steps">
                            <div class="progress-bar" style="width: ${progressWidth};"></div>
                            <div class="progress-step ${completedSteps >= 0 ? 'step-completed' : ''} ${order.status === 'pending' ? 'step-active' : ''}">
                                <div class="step-icon">
                                    <i class="fas ${completedSteps >= 0 ? 'fa-check' : 'fa-shopping-cart'}"></i>
                                </div>
                                <div class="step-label">Ordered</div>
                            </div>
                            <div class="progress-step ${completedSteps >= 1 ? 'step-completed' : ''} ${order.status === 'preparing' ? 'step-active' : ''}">
                                <div class="step-icon">
                                    <i class="fas ${completedSteps >= 1 ? 'fa-check' : 'fa-utensils'}"></i>
                                </div>
                                <div class="step-label">Preparing</div>
                            </div>
                            <div class="progress-step ${completedSteps >= 2 ? 'step-completed' : ''} ${order.status === 'ready' ? 'step-active' : ''}">
                                <div class="step-icon">
                                    <i class="fas ${completedSteps >= 2 ? 'fa-check' : 'fa-box'}"></i>
                                </div>
                                <div class="step-label">Ready</div>
                            </div>
                            <div class="progress-step ${completedSteps >= 3 ? 'step-completed' : ''} ${order.status === 'delivered' ? 'step-active' : ''}">
                                <div class="step-icon">
                                    <i class="fas ${completedSteps >= 3 ? 'fa-check' : 'fa-truck'}"></i>
                                </div>
                                <div class="step-label">Delivered</div>
                            </div>
                        </div>
                    </div>
                    ` : ''}
                    ${order.status !== 'delivered' && order.status !== 'cancelled' ? `
                    <div style="margin-top: 20px; display: flex; justify-content: flex-end;">
                        <button class="cancel-order-btn" data-id="${order.id}">
                            <i class="fas fa-times"></i>
                            Cancel Order
                        </button>
                    </div>
                    ` : ''}
                `;
                trackingContainer.appendChild(orderCard);
            });
        }

        // Render tracking summary
        function renderTrackingSummary() {
            if (orders.length === 0) {
                trackingSummaryElement.innerHTML = '<p>You have no orders yet.</p>';
                return;
            }
            
            const pendingOrders = orders.filter(order => order.status === 'pending').length;
            const preparingOrders = orders.filter(order => order.status === 'preparing').length;
            const readyOrders = orders.filter(order => order.status === 'ready').length;
            const deliveredOrders = orders.filter(order => order.status === 'delivered').length;
            const cancelledOrders = orders.filter(order => order.status === 'cancelled').length;
            
            trackingSummaryElement.innerHTML = `
                <div style="margin-bottom: 15px;">
                    <h4 style="color: var(--dark); margin-bottom: 5px;">Total Orders</h4>
                    <p style="font-size: 24px; font-weight: bold; color: var(--primary);">${orders.length}</p>
                </div>
                <div style="margin-bottom: 15px;">
                    <h4 style="color: var(--dark); margin-bottom: 5px;">Pending</h4>
                    <p style="font-size: 18px; color: var(--warning);">${pendingOrders}</p>
                </div>
                <div style="margin-bottom: 15px;">
                    <h4 style="color: var(--dark); margin-bottom: 5px;">Preparing</h4>
                    <p style="font-size: 18px; color: var(--accent);">${preparingOrders}</p>
                </div>
                <div style="margin-bottom: 15px;">
                    <h4 style="color: var(--dark); margin-bottom: 5px;">Ready</h4>
                    <p style="font-size: 18px; color: var(--secondary);">${readyOrders}</p>
                </div>
                <div style="margin-bottom: 15px;">
                    <h4 style="color: var(--dark); margin-bottom: 5px;">Delivered</h4>
                    <p style="font-size: 18px; color: var(--success);">${deliveredOrders}</p>
                </div>
                <div style="margin-bottom: 15px;">
                    <h4 style="color: var(--dark); margin-bottom: 5px;">Cancelled</h4>
                    <p style="font-size: 18px; color: var(--danger);">${cancelledOrders}</p>
                </div>
            `;
        }

        // Render order history as vertical cards
        function renderOrderHistory() {
            const orderHistoryCardsContainer = document.getElementById('order-history-cards');
            orderHistoryCardsContainer.innerHTML = '';
            
            if (orderHistory.length === 0) {
                orderHistoryCardsContainer.style.display = 'none';
                document.getElementById('order-history-empty').style.display = 'block';
                return;
            }
            
            orderHistoryCardsContainer.style.display = 'grid';
            document.getElementById('order-history-empty').style.display = 'none';
            
            // Show orders in reverse chronological order (newest first)
            orderHistory.reverse().forEach(order => {
                const historyCard = document.createElement('div');
                historyCard.className = 'history-card';
                historyCard.innerHTML = `
                    <div class="history-card-header">
                        <div>
                            <div class="history-order-id">Order #${order.id}</div>
                            <div class="history-order-date">${order.date}</div>
                        </div>
                        <div class="history-status status-${order.status}">${order.status.charAt(0).toUpperCase() + order.status.slice(1)}</div>
                    </div>
                    <div class="history-details">
                        <div class="history-detail-row">
                            <div class="history-detail-label">Customer:</div>
                            <div class="history-detail-value">${order.customerName}</div>
                        </div>
                        <div class="history-detail-row">
                            <div class="history-detail-label">Contact:</div>
                            <div class="history-detail-value">${order.customerContact}</div>
                        </div>
                        <div class="history-detail-row">
                            <div class="history-detail-label">Items:</div>
                            <div class="history-detail-value">${order.items.map(item => `${item.name} (${item.quantity})`).join(', ')}</div>
                        </div>
                        <div class="history-detail-row">
                            <div class="history-detail-label">Total:</div>
                            <div class="history-detail-value">₱${order.total.toFixed(2)}</div>
                        </div>
                        <div class="history-detail-row">
                            <div class="history-detail-label">Payment Method:</div>
                            <div class="history-detail-value">${order.paymentMethod}</div>
                        </div>
                        <div class="history-detail-row">
                            <div class="history-detail-label">Delivery Address:</div>
                            <div class="history-detail-value">${order.location}</div>
                        </div>
                        ${order.cancelReason ? `
                        <div class="history-detail-row">
                            <div class="history-detail-label">Cancellation Reason:</div>
                            <div class="history-detail-value">${order.cancelReason}</div>
                        </div>
                        ` : ''}
                    </div>
                `;
                orderHistoryCardsContainer.appendChild(historyCard);
            });
        }

        // Move delivered and cancelled orders to history
        function moveDeliveredOrdersToHistory() {
            const completedOrders = orders.filter(order => order.status === 'delivered' || order.status === 'cancelled');
            
            completedOrders.forEach(completedOrder => {
                // Check if order is already in history
                if (!orderHistory.find(historyOrder => historyOrder.id === completedOrder.id)) {
                    orderHistory.push({
                        ...completedOrder,
                        completedDate: new Date().toLocaleDateString()
                    });
                }
            });
            
            // Remove completed orders from current orders
            orders = orders.filter(order => order.status !== 'delivered' && order.status !== 'cancelled');
            
            // Update order history display if on that page
            if (document.getElementById('order-history').classList.contains('active')) {
                renderOrderHistory();
            }
        }

        // Toggle password visibility
        function togglePasswordVisibility(passwordField, toggleButton) {
            const type = passwordField.getAttribute('type') === 'password' ? 'text' : 'password';
            passwordField.setAttribute('type', type);
            
            // Toggle eye icon
            if (type === 'text') {
                toggleButton.innerHTML = '<i class="fas fa-eye-slash"></i>';
            } else {
                toggleButton.innerHTML = '<i class="fas fa-eye"></i>';
            }
        }

        // Validate address for both payment methods
        function validateAddress() {
            const location = deliveryLocationInput.value.trim();
            const customerName = customerNameInput.value.trim();
            const customerContact = customerContactInput.value.trim();
            
            if (!customerName) {
                showNotification('Please enter your full name', 'error');
                return false;
            }
            
            if (!customerContact || customerContact.length !== 11 || !customerContact.startsWith('09')) {
                showNotification('Please enter a valid contact number (09XXXXXXXXX)', 'error');
                return false;
            }
            
            if (!location) {
                showNotification('Please enter your delivery address', 'error');
                return false;
            }
            
            userLocation = location;
            return true;
        }

        // Setup event listeners
        function setupEventListeners() {
            // Login form submission
            loginForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const username = loginUsername.value;
                const password = loginPassword.value;
                
                // Find user with matching credentials and role
                const user = users.find(u => 
                    u.username === username && 
                    u.password === password && 
                    u.role === selectedLoginRole
                );
                
                if (user) {
                    currentUser = user;
                    // Save username for future suggestions
                    saveUsername(selectedLoginRole, username);
                    
                    loginPage.style.display = 'none';
                    dashboard.classList.add('active');
                    updateUserInterface();
                    showNotification(`Welcome, ${user.name}!`, 'success');
                } else {
                    loginError.textContent = `Invalid ${selectedLoginRole} credentials. Please try again.`;
                }
            });
            
            // Login tab events - UPDATED TO CLEAR USERNAME FIELD
            loginTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    selectedLoginRole = tab.getAttribute('data-role');
                    updateLoginTabs();
                    loginError.textContent = '';
                    // Clear username field when switching tabs
                    loginUsername.value = '';
                    // Clear suggestions when changing role
                    usernameSuggestions.style.display = 'none';
                });
            });
            
            // Username input focus event for suggestions - IMPROVED
            loginUsername.addEventListener('focus', () => {
                showUsernameSuggestions();
            });
            
            // Username input typing event - NEW
            loginUsername.addEventListener('input', () => {
                const suggestionsList = document.getElementById('username-suggestions');
                if (suggestionsList.style.display === 'block') {
                    // Filter suggestions based on input
                    filterSuggestions();
                }
            });
            
            // Hide suggestions when clicking outside - IMPROVED
            document.addEventListener('click', (e) => {
                if (!e.target.closest('.suggestions-container') && 
                    !e.target.closest('.suggestions-list')) {
                    usernameSuggestions.style.display = 'none';
                }
            });
            
            // Logout button
            logoutBtn.addEventListener('click', () => {
                currentUser = null;
                dashboard.classList.remove('active');
                loginPage.style.display = 'flex';
                loginUsername.value = '';
                loginPassword.value = '';
                loginError.textContent = '';
            });
            
            // Password visibility toggle
            toggleLoginPassword.addEventListener('click', () => {
                togglePasswordVisibility(loginPassword, toggleLoginPassword);
            });
            
            // Navigation buttons
            navButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const sectionId = button.getAttribute('data-section');
                    showSection(sectionId);
                });
            });
            
            // Menu management buttons
            addNewItemButton.addEventListener('click', openAddMenuItemModal);
            
            // User management buttons
            addNewUserButton.addEventListener('click', openAddUserModal);
            
            // Menu item modal events
            menuItemForm.addEventListener('submit', saveMenuItem);
            closeMenuModal.addEventListener('click', () => {
                menuItemModal.classList.remove('active');
            });
            cancelMenuItem.addEventListener('click', () => {
                menuItemModal.classList.remove('active');
            });
            
            // User modal events
            userForm.addEventListener('submit', saveUser);
            closeUserModal.addEventListener('click', () => {
                userModal.classList.remove('active');
            });
            cancelUser.addEventListener('click', () => {
                userModal.classList.remove('active');
            });
            
            // Password visibility toggles
            toggleUserPassword.addEventListener('click', () => {
                togglePasswordVisibility(userPassword, toggleUserPassword);
            });
            
            // Add to cart (delegated event)
            menuItemsContainer.addEventListener('click', (e) => {
                if (e.target.closest('.add-to-cart')) {
                    const itemId = parseInt(e.target.closest('.add-to-cart').getAttribute('data-id'));
                    addToCart(itemId);
                }
            });
            
            // Cart operations (delegated events)
            cartCardsContainer.addEventListener('click', (e) => {
                if (e.target.closest('.increase-quantity')) {
                    const itemId = parseInt(e.target.closest('.increase-quantity').getAttribute('data-id'));
                    increaseQuantity(itemId);
                } else if (e.target.closest('.decrease-quantity')) {
                    const itemId = parseInt(e.target.closest('.decrease-quantity').getAttribute('data-id'));
                    decreaseQuantity(itemId);
                } else if (e.target.closest('.remove-btn')) {
                    const itemId = parseInt(e.target.closest('.remove-btn').getAttribute('data-id'));
                    removeFromCart(itemId);
                }
            });
            
            // Proceed to payment
            proceedToPaymentButton.addEventListener('click', () => {
                if (cart.length === 0) {
                    showNotification('Your cart is empty', 'warning');
                    return;
                }
                showSection('payment');
            });
            
            // Payment method selection
            paymentMethods.forEach(method => {
                method.addEventListener('click', () => {
                    paymentMethods.forEach(m => m.classList.remove('selected'));
                    method.classList.add('selected');
                    
                    // Show/hide appropriate forms based on payment method
                    const paymentMethod = method.getAttribute('data-method');
                    if (paymentMethod === 'cod') {
                        gcashPaymentForm.style.display = 'none';
                        codInfo.style.display = 'block';
                        confirmGcashPaymentButton.style.display = 'none';
                        completeCodPaymentButton.style.display = 'block';
                    } else if (paymentMethod === 'gcash') {
                        gcashPaymentForm.style.display = 'block';
                        codInfo.style.display = 'none';
                        confirmGcashPaymentButton.style.display = 'block';
                        completeCodPaymentButton.style.display = 'none';
                    }
                });
            });
            
            // Confirm GCash payment
            confirmGcashPaymentButton.addEventListener('click', () => {
                if (!validateAddress()) {
                    return;
                }
                
                // Simulate GCash payment processing
                showNotification('Processing GCash payment...', 'info');
                
                setTimeout(() => {
                    createOrder('GCash');
                    showNotification('GCash payment successful! Order placed.', 'success');
                }, 2000);
            });
            
            // Complete COD payment
            completeCodPaymentButton.addEventListener('click', () => {
                if (!validateAddress()) {
                    return;
                }
                
                createOrder('Cash on Delivery');
                showNotification('COD order placed successfully!', 'success');
            });
            
            // Update order status (delegated event)
            ordersTableBody.addEventListener('change', (e) => {
                if (e.target.classList.contains('update-status')) {
                    const orderId = parseInt(e.target.getAttribute('data-id'));
                    const newStatus = e.target.value;
                    updateOrderStatus(orderId, newStatus);
                }
            });
            
            // Menu management (delegated events)
            menuTableBody.addEventListener('click', (e) => {
                if (e.target.closest('.edit-item')) {
                    const itemId = parseInt(e.target.closest('.edit-item').getAttribute('data-id'));
                    openEditMenuItemModal(itemId);
                } else if (e.target.closest('.delete-item')) {
                    const itemId = parseInt(e.target.closest('.delete-item').getAttribute('data-id'));
                    deleteMenuItem(itemId);
                }
            });
            
            // User management (delegated events)
            usersList.addEventListener('click', (e) => {
                if (e.target.closest('.edit-user')) {
                    const userId = parseInt(e.target.closest('.edit-user').getAttribute('data-id'));
                    openEditUserModal(userId);
                } else if (e.target.closest('.delete-user')) {
                    const userId = parseInt(e.target.closest('.delete-user').getAttribute('data-id'));
                    deleteUser(userId);
                }
            });
            
            // Cancel order modal events
            closeCancelModal.addEventListener('click', () => {
                cancelOrderModal.classList.remove('active');
                orderToCancel = null;
                cancelReason.value = '';
            });
            
            cancelCancelOrder.addEventListener('click', () => {
                cancelOrderModal.classList.remove('active');
                orderToCancel = null;
                cancelReason.value = '';
            });
            
            confirmCancelOrder.addEventListener('click', () => {
                if (orderToCancel) {
                    cancelOrder(orderToCancel, cancelReason.value);
                    cancelOrderModal.classList.remove('active');
                    orderToCancel = null;
                    cancelReason.value = '';
                }
            });
            
            // Cancel order button (delegated event)
            orderTrackingContainer.addEventListener('click', (e) => {
                if (e.target.closest('.cancel-order-btn')) {
                    const orderId = parseInt(e.target.closest('.cancel-order-btn').getAttribute('data-id'));
                    openCancelOrderModal(orderId);
                }
            });
        }

        // Create order
        function createOrder(paymentMethod) {
            const customerName = customerNameInput.value;
            const customerContact = customerContactInput.value;
            const deliveryLocation = deliveryLocationInput.value;
            
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const order = {
                id: currentOrderId++,
                customer: currentUser.name,
                customerName: customerName,
                customerContact: customerContact,
                items: [...cart],
                total: total,
                paymentMethod: paymentMethod,
                status: 'pending',
                date: new Date().toLocaleDateString(),
                location: deliveryLocation
            };
            
            orders.push(order);
            
            // Update GCash order ID for next order
            gcashOrderIdElement.textContent = `#${currentOrderId}`;
            
            // Clear cart and form fields
            cart = [];
            customerNameInput.value = '';
            customerContactInput.value = '';
            deliveryLocationInput.value = '';
            updateCartCount();
            
            // Return to browse menu after a delay
            setTimeout(() => {
                showSection('browse-menu');
            }, 2000);
        }

        // Cart functions
        function addToCart(itemId) {
            const item = menuItems.find(menuItem => menuItem.id === itemId);
            const existingItem = cart.find(cartItem => cartItem.id === itemId);
            
            if (existingItem) {
                existingItem.quantity++;
            } else {
                cart.push({
                    id: item.id,
                    name: item.name,
                    price: item.price,
                    quantity: 1
                });
            }
            
            updateCartCount();
            showNotification(`${item.name} added to cart`, 'success');
        }

        function increaseQuantity(itemId) {
            const item = cart.find(cartItem => cartItem.id === itemId);
            if (item) {
                item.quantity++;
                renderCart();
                updateCartCount();
            }
        }

        function decreaseQuantity(itemId) {
            const item = cart.find(cartItem => cartItem.id === itemId);
            if (item) {
                item.quantity--;
                if (item.quantity <= 0) {
                    removeFromCart(itemId);
                } else {
                    renderCart();
                    updateCartCount();
                }
            }
        }

        function removeFromCart(itemId) {
            const item = cart.find(item => item.id === itemId);
            cart = cart.filter(item => item.id !== itemId);
            renderCart();
            updateCartCount();
            showNotification(`${item.name} removed from cart`, 'info');
        }

        // Show notification
        function showNotification(message, type = 'info') {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            
            let icon = 'fa-info-circle';
            let title = 'Information';
            
            switch(type) {
                case 'success':
                    icon = 'fa-check-circle';
                    title = 'Success';
                    break;
                case 'error':
                    icon = 'fa-exclamation-circle';
                    title = 'Error';
                    break;
                case 'warning':
                    icon = 'fa-exclamation-triangle';
                    title = 'Warning';
                    break;
            }
            
            notification.innerHTML = `
                <div class="notification-icon">
                    <i class="fas ${icon}"></i>
                </div>
                <div class="notification-content">
                    <div class="notification-title">${title}</div>
                    <div class="notification-message">${message}</div>
                </div>
            `;
            document.body.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.classList.add('show');
            }, 10);
            
            // Animate out and remove
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 4000);
        }

        // Order management functions
        function updateOrderStatus(orderId, newStatus) {
            const order = orders.find(order => order.id === orderId);
            if (order) {
                order.status = newStatus;
                
                // If order is delivered or cancelled, move it to history
                if (newStatus === 'delivered' || newStatus === 'cancelled') {
                    moveDeliveredOrdersToHistory();
                    // Update both orders table and order history if on those pages
                    if (document.getElementById('view-orders').classList.contains('active')) {
                        renderOrdersTable();
                    }
                    if (document.getElementById('order-history').classList.contains('active')) {
                        renderOrderHistory();
                    }
                }
                
                renderOrdersTable();
                showNotification(`Order #${orderId} status updated to ${newStatus}`, 'success');
            }
        }

        // Cancel order functions
        function openCancelOrderModal(orderId) {
            orderToCancel = orderId;
            cancelOrderModal.classList.add('active');
        }

        function cancelOrder(orderId, reason) {
            const order = orders.find(order => order.id === orderId);
            if (order) {
                order.status = 'cancelled';
                order.cancelReason = reason || 'No reason provided';
                
                // Move cancelled order to history
                moveDeliveredOrdersToHistory();
                
                // Update UI
                if (document.getElementById('track-order').classList.contains('active')) {
                    renderOrderTracking();
                    renderTrackingSummary();
                }
                if (document.getElementById('order-history').classList.contains('active')) {
                    renderOrderHistory();
                }
                
                showNotification(`Order #${orderId} has been cancelled`, 'success');
            }
        }

        // Menu item modal functions
        function openAddMenuItemModal() {
            menuModalTitle.textContent = 'Add Menu Item';
            menuItemForm.reset();
            menuItemId.value = '';
            menuItemModal.classList.add('active');
        }

        function openEditMenuItemModal(itemId) {
            const item = menuItems.find(item => item.id === itemId);
            if (item) {
                menuModalTitle.textContent = 'Edit Menu Item';
                menuItemId.value = item.id;
                menuItemName.value = item.name;
                menuItemDescription.value = item.description;
                menuItemPrice.value = item.price;
                menuItemImageUrl.value = item.image;
                menuItemModal.classList.add('active');
            }
        }

        function saveMenuItem(event) {
            event.preventDefault();
            
            const id = menuItemId.value ? parseInt(menuItemId.value) : nextMenuItemId++;
            const name = menuItemName.value;
            const description = menuItemDescription.value;
            const price = parseFloat(menuItemPrice.value);
            const image = menuItemImageUrl.value || 'default-cake.jpg';
            
            if (menuItemId.value) {
                // Edit existing item
                const index = menuItems.findIndex(item => item.id === id);
                if (index !== -1) {
                    menuItems[index] = { id, name, description, price, image };
                    showNotification('Menu item updated successfully', 'success');
                }
            } else {
                // Add new item
                menuItems.push({ id, name, description, price, image });
                showNotification('Menu item added successfully', 'success');
            }
            
            // Update UI
            renderMenuTable();
            renderMenuItems();
            menuItemModal.classList.remove('active');
        }

        function deleteMenuItem(itemId) {
            if (confirm('Are you sure you want to delete this menu item?')) {
                menuItems = menuItems.filter(item => item.id !== itemId);
                renderMenuTable();
                renderMenuItems();
                showNotification('Menu item deleted successfully', 'success');
            }
        }

        // User modal functions
        function openAddUserModal() {
            userModalTitle.textContent = 'Add User';
            userForm.reset();
            userId.value = '';
            userModal.classList.add('active');
        }

        function openEditUserModal(userId) {
            const user = users.find(user => user.id === userId);
            if (user) {
                userModalTitle.textContent = 'Edit User';
                userId.value = user.id;
                userName.value = user.name;
                userUsername.value = user.username;
                userPassword.value = user.password;
                userRole.value = user.role;
                userModal.classList.add('active');
            }
        }

        function saveUser(event) {
            event.preventDefault();
            
            const id = userId.value ? parseInt(userId.value) : nextUserId++;
            const name = userName.value;
            const username = userUsername.value;
            const password = userPassword.value;
            const role = userRole.value;
            
            if (userId.value) {
                // Edit existing user
                const index = users.findIndex(user => user.id === id);
                if (index !== -1) {
                    users[index] = { id, name, username, password, role };
                    showNotification('User updated successfully', 'success');
                }
            } else {
                // Add new user
                users.push({ id, name, username, password, role });
                showNotification('User added successfully', 'success');
            }
            
            // Update UI
            renderUsersList();
            userModal.classList.remove('active');
        }

        function deleteUser(userId) {
            if (userId === currentUser.id) {
                showNotification('You cannot delete your own account', 'error');
                return;
            }
            
            if (confirm('Are you sure you want to delete this user?')) {
                users = users.filter(user => user.id !== userId);
                renderUsersList();
                showNotification('User deleted successfully', 'success');
            }
        }

        // Initialize the application
        init();
    </script>
</body>
</html>